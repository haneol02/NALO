# 2. 핵심 기능

NALO는 3가지 주요 워크플로우를 통해 아이디어를 구체화합니다.

---

## 2.1 주제 탐색 (Research-Driven Ideation)

### 기능 개요
주제 탐색은 사용자의 초기 아이디어를 다각도로 확장하고, 다양한 소스에서 리서치 데이터를 수집하여 **데이터 기반의 아이디어**를 생성하는 기능입니다.

### 워크플로우
```
사용자 프롬프트 입력
    ↓
[1단계] 키워드 추출 (GPT)
    ↓
[2단계] 주제 확장 생성 (GPT, 3개)
    ↓
[3단계] 사용자 주제 선택 + 추가 확장 (최대 3단계 깊이)
    ↓
[4단계] 리서치 옵션 선택
    ↓
[5단계] 다중 소스 통합 리서치
    ├─ Wikipedia 검색
    ├─ OpenAlex 학술 논문 검색
    └─ Perplexity AI 웹 리서치
    ↓
[6단계] 리서치 기반 아이디어 생성 (GPT)
    ↓
[7단계] 상세 기획서 생성
```

### 주요 특징

#### 1. **키워드 기반 주제 확장**
- GPT를 활용한 스마트 키워드 추출
- 3개의 다양한 방향으로 주제 확장
- 사용자가 관심 있는 방향으로 **최대 3단계까지 확장** 가능
- 각 단계에서 여러 주제를 선택하여 다각도 탐색 지원

**예시**:
```
초기 입력: "친환경 배달 서비스"

1단계 확장:
- 전기 자전거 배달 플랫폼
- 재사용 가능한 포장 시스템
- 탄소 발자국 추적 앱

2단계 확장 (전기 자전거 선택):
- 배달원 전용 전기 자전거 구독 서비스
- 배터리 교환 스테이션 네트워크
- 라이더 건강 관리 연동 시스템
```

#### 2. **다중 소스 통합 리서치**

##### 2.1 Wikipedia 리서치
- **목적**: 기본 개념 이해 및 시장 개요 파악
- **방법**: Wikipedia API를 통한 자동 검색
- **데이터**: 요약 텍스트, 본문 발췌, 출처 URL
- **활용**: 시장 배경, 용어 정의, 역사적 맥락

##### 2.2 OpenAlex 학술 논문 리서치
- **목적**: 최신 연구 동향 및 기술적 근거 확보
- **방법**: OpenAlex API를 통한 학술 논문 검색
- **데이터**: 논문 제목, 저자, 초록, 인용 수, 출판 연도
- **필터링**: 인용 수 기반 영향력 높은 논문 우선
- **활용**: 기술적 타당성, 선행 연구, 학술적 근거

##### 2.3 Perplexity AI 웹 리서치
- **목적**: 최신 트렌드, 시장 동향, 실제 사례 수집
- **방법**: Perplexity AI Sonar API를 통한 실시간 웹 검색
- **데이터**: 최신 기사, 블로그, 보고서, 통계
- **활용**: 시장 트렌드, 경쟁사 분석, 최신 사례

##### 2.4 리서치 통합 프로세스
```typescript
// /app/api/research/route.ts 핵심 로직

1. 주제 핵심 분석 (GPT)
   - 입력된 주제의 본질 파악
   - 서비스/제품의 핵심 가치 추출

2. 검색 키워드 생성 (GPT)
   - 주제 분석 기반으로 최적화된 검색어 생성
   - 다중 키워드 조합 (Wikipedia용, 학술용, 웹용)

3. 병렬 검색 실행
   - 3개 API 동시 호출 (Promise.all)
   - 각 소스별 독립적 검색

4. 관련성 필터링
   - 관련성 점수 계산 (키워드 매칭)
   - 상위 결과만 선택 (Wikipedia 3개, OpenAlex 5개, Perplexity 5개)

5. 중복 제거
   - 제목 기반 Set 사용
   - 유사 내용 병합
```

#### 3. **리서치 기반 아이디어 생성**
- 수집된 리서치 데이터를 GPT에 컨텍스트로 제공
- **데이터 기반 아이디어** 생성 (막연한 아이디어가 아닌, 근거 있는 아이디어)
- 시장 현황, 기술 동향, 학술 연구를 반영한 실현 가능한 아이디어 도출

#### 4. **상세 기획서 자동 생성**
- 리서치 데이터를 기획서에 자동 포함
- 참고 자료 섹션에 출처 명시
- 시장 분석, 경쟁 분석에 실제 데이터 활용

---

## 2.2 마인드맵 브레인스토밍 (Mindmap-Based Ideation)

### 기능 개요
마인드맵 브레인스토밍은 **시각적 사고 도구**를 통해 아이디어를 자유롭게 확장하고 구조화하는 기능입니다. AI와의 대화를 통해 실시간으로 마인드맵을 편집하고, 웹 검색 기반으로 최신 정보를 반영할 수 있습니다.

### 워크플로우
```
사용자 프롬프트 입력
    ↓
[1단계] 자동 마인드맵 생성 (GPT)
    - 중심 노드 1개
    - 하위 노드 5-7개
    ↓
[2단계] 마인드맵 편집
    ├─ 수동 편집: 노드 추가/삭제/수정/이동
    ├─ AI 채팅: 자연어로 마인드맵 편집 요청
    └─ 스마트 확장: 웹 검색 기반 노드 확장
    ↓
[3단계] 마인드맵 분석 (구조화)
    ↓
[4단계] 마인드맵 기반 기획서 생성
```

### 주요 특징

#### 1. **자동 마인드맵 생성**
- 사용자 프롬프트를 분석하여 **루트 노드**와 **5-7개 하위 노드** 자동 생성
- 계층 구조를 고려한 지능적 배치
- ReactFlow 라이브러리 기반 시각적 렌더링

**생성 예시**:
```json
{
  "rootNode": {
    "id": "root",
    "label": "AI 학습 도우미 플랫폼",
    "type": "root"
  },
  "childNodes": [
    { "id": "1", "label": "개인 맞춤형 학습 경로", "parentId": "root" },
    { "id": "2", "label": "실시간 질문 응답 챗봇", "parentId": "root" },
    { "id": "3", "label": "학습 진도 추적 대시보드", "parentId": "root" },
    { "id": "4", "label": "AI 문제 추천 시스템", "parentId": "root" },
    { "id": "5", "label": "학습 데이터 분석", "parentId": "root" }
  ]
}
```

#### 2. **AI 채팅 기반 편집**

마인드맵 내 **채팅 인터페이스**를 통해 자연어로 마인드맵을 편집할 수 있습니다.

##### 지원 명령어 (15가지 액션)
```typescript
// /app/components/MindmapViewer.tsx에 정의된 액션

1. ADD_NODE: 새 노드 추가
2. DELETE_NODE: 노드 삭제
3. EDIT_NODE: 노드 텍스트 수정
4. ADD_CHILD: 특정 노드에 자식 추가
5. MOVE_NODE: 노드 부모 변경 (구조 변경)
6. MERGE_NODES: 여러 노드를 하나로 병합
7. SPLIT_NODE: 하나의 노드를 여러 개로 분할
8. EXPAND_NODE: AI로 하위 아이디어 자동 생성
9. ADD_SIBLING: 형제 노드 추가
10. CHANGE_COLOR: 노드 색상 변경
11. GROUP_NODES: 노드 그룹화
12. ADD_CONNECTION: 노드 간 연결 추가
13. ADD_NOTE: 노드에 메모 추가
14. PRIORITIZE: 노드 우선순위 설정
15. ANALYZE: 마인드맵 구조 분석 및 제안
```

##### 대화 예시
```
사용자: "게임화 요소를 추가해줘"
AI: [COMMAND]{"action":"ADD_NODE","label":"게임화 요소","parentId":"root"}

사용자: "게임화 요소를 더 구체화해줘"
AI: [COMMAND]{"action":"ADD_CHILD","parentId":"게임화ID","children":["포인트 시스템","레벨 시스템","랭킹 보드","일일 퀘스트"]}

사용자: "포인트 시스템 노드를 확장해줘"
AI: [COMMAND]{"action":"EXPAND_NODE","nodeId":"포인트ID"}
```

##### AI 모델 선택
- **OpenAI GPT**: 빠른 응답, 정확한 명령 파싱
- **Perplexity Sonar**: 웹 검색 기반 최신 정보 반영

##### 스트리밍 응답
- Server-Sent Events (SSE) 방식으로 실시간 응답
- 토큰 단위 스트리밍으로 **사용자 경험 향상**
- 명령어는 응답 완료 후 일괄 파싱 및 실행

#### 3. **스마트 확장 (Smart Expand)**

선택한 노드를 **웹 검색 기반**으로 자동 확장하는 기능입니다.

```
노드 선택 (예: "블록체인 보안")
    ↓
웹 검색 실행 (Perplexity AI)
    ↓
관련 최신 정보 수집
    ↓
GPT로 하위 아이디어 생성 (3-5개)
    ↓
마인드맵에 자동 추가
```

**활용 예시**:
- 최신 기술 트렌드 반영 (예: "메타버스" → 최신 메타버스 플랫폼 동향)
- 실제 사례 수집 (예: "친환경 패키징" → 실제 기업 사례)
- 통계 데이터 반영 (예: "시니어 시장" → 최신 시장 규모 데이터)

#### 4. **수동 편집 기능**

##### 노드 조작
- **추가**: 빈 공간 더블클릭 또는 버튼 클릭
- **삭제**: 노드 선택 후 Delete 키 또는 버튼
- **수정**: 노드 더블클릭으로 텍스트 편집
- **이동**: 드래그 앤 드롭으로 부모 변경

##### 연결 관리
- 노드 간 연결선 자동 생성
- 계층 구조 시각화 (트리 레이아웃)
- 부모-자식 관계 명확한 표시

##### 색상 커스터마이징
- 루트 노드: 파란색 (blue-600)
- 일반 노드: 흰색 배경, 파란색 테두리
- 사용자 지정 색상 설정 가능

#### 5. **마인드맵 저장 및 불러오기**
- JSON 형식으로 마인드맵 저장
- 로컬 스토리지 또는 파일 다운로드
- 저장된 마인드맵 불러오기 및 이어서 편집

#### 6. **마인드맵 기반 기획서 생성**

마인드맵의 구조를 분석하여 **체계적인 기획서**로 자동 변환합니다.

```typescript
// 마인드맵 분석 예시
{
  "structure": "루트: AI 학습 도우미 플랫폼\n" +
               "- 개인 맞춤형 학습 경로\n" +
               "  - 학습 스타일 진단\n" +
               "  - 커리큘럼 자동 생성\n" +
               "- 실시간 질문 응답 챗봇\n" +
               "  - 자연어 처리\n" +
               "  - 다국어 지원\n",
  "keyFeatures": ["개인 맞춤형 학습 경로", "실시간 질문 응답 챗봇", ...],
  "technicalRequirements": ["AI/ML", "자연어 처리", "데이터 분석", ...]
}
```

이 분석 데이터를 GPT에 제공하여 마인드맵의 **구조와 맥락을 반영한 기획서** 생성

---

## 2.3 직접 생성 (Quick Ideation)

### 기능 개요
가장 빠른 방식으로 아이디어를 생성하는 기능입니다. 사용자 프롬프트를 직접 GPT에 입력하여 **즉시 3개의 아이디어**를 생성합니다.

### 워크플로우
```
사용자 프롬프트 입력
    ↓
GPT-4o-mini로 즉시 아이디어 생성 (3개)
    ↓
아이디어 선택
    ↓
상세 기획서 생성
```

### 주요 특징
- **가장 빠른 방식**: 리서치나 마인드맵 과정 없이 즉시 생성
- **다양성 확보**: 3개의 다른 방향 아이디어 제공
- **간단한 프로젝트에 적합**: 빠른 브레인스토밍, 간단한 사이드 프로젝트

---

## 2.4 AI 기획서 자동 생성

모든 워크플로우의 최종 단계는 **전문적인 기획서 자동 생성**입니다.

### 기획서 구조

#### 1. **기본 정보**
- 프로젝트명
- 서비스 요약 (1-2문장)
- 작성일
- 프로젝트 유형 (웹 서비스, 모바일 앱, IoT, AI/ML 등)

#### 2. **프로젝트 개요**
- 핵심 아이디어 (Core Idea)
- 프로젝트 배경 (Background)
- 타겟 고객 (Target Customer)

#### 3. **문제 정의 및 솔루션**
- 해결하고자 하는 문제 (Problem to Solve)
- 제안하는 솔루션 (Proposed Solution)

#### 4. **목표 및 지표**
- 주요 목표 (Main Objectives) - 3-5개
- 성공 지표 (Success Metrics) - KPI

#### 5. **기능 명세**
- 기능 목록 (Features) - 상세 설명 포함
- 핵심 기능 (Key Features) - 3-5개 강조

#### 6. **기술 스택**
- 프론트엔드 기술
- 백엔드 기술
- 데이터베이스
- AI/ML 모델 (해당 시)
- 기타 도구 및 라이브러리

#### 7. **시스템 아키텍처**
- 전체 시스템 구조 설명
- 주요 컴포넌트 및 역할
- 데이터 흐름

#### 8. **예산 및 비용**
- 개발 비용 (만원 단위)
- 운영 비용 (월별)
- 마케팅 비용
- 기타 비용

#### 9. **일정 및 마일스톤**
- 개발 기간 (주 단위)
- 주요 마일스톤

#### 10. **리스크 분석**
- 주요 리스크 요인 (Risk Factors)
- 리스크 대응 방안 (Risk Response)
- 비상 계획 (Contingency Plan)

#### 11. **참고 자료** (리서치 기반 생성 시)
- Wikipedia 링크
- 학술 논문 링크
- 웹 리서치 출처

### 기획서 템플릿

프로젝트는 **3가지 프롬프트 템플릿**을 제공합니다:

#### 1. **SIMPLE_IDEA_PROMPT** (`/app/lib/project-templates.ts`)
- 간단한 아이디어 생성용
- 기본 필드만 포함
- 빠른 브레인스토밍에 적합

#### 2. **IDEA_PLAN_PROMPT** (243줄)
- 표준 기획서 생성용
- 실무에서 사용 가능한 수준
- 리서치 데이터 통합 지원

#### 3. **DETAILED_PROJECT_PROMPT** (365줄)
- 초상세 기획서 생성용
- 투자 유치용, IR 자료로 활용 가능
- 시장 분석, 경쟁 분석, 재무 계획까지 포함

### PDF 다운로드

생성된 기획서는 **PDF로 다운로드** 가능합니다.

**기술 스택**:
- `jsPDF`: PDF 생성 라이브러리
- `html2canvas`: HTML을 이미지로 변환 (PDF 삽입용)

**구현 방식**:
```typescript
// /app/plan/[id]/page.tsx

const downloadPDF = async () => {
  const element = document.getElementById('plan-content');
  const canvas = await html2canvas(element);
  const imgData = canvas.toDataURL('image/png');

  const pdf = new jsPDF('p', 'mm', 'a4');
  const imgWidth = 210;
  const imgHeight = (canvas.height * imgWidth) / canvas.width;

  pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
  pdf.save(`${projectName}_기획서.pdf`);
};
```

---

## 2.5 사용자 인증 및 데이터 관리

### Supabase 인증
- **이메일/비밀번호** 로그인
- **OAuth** 지원 (Google, GitHub 등)
- **익명 사용자**: 로그인 없이도 사용 가능 (저장 기능 제한)

### 데이터 저장
- 생성된 기획서는 **Supabase PostgreSQL**에 저장
- 사용자별 기획서 목록 관리
- **소유자만** 삭제 가능 (권한 관리)

### 공유 기능
- 기획서 고유 ID로 **URL 공유** 가능
- 공개 링크로 누구나 열람 가능
- 복사 방지 및 워터마크 옵션 (향후 구현 예정)

---

## 2.6 기능 비교표

| 기능 | 주제 탐색 | 마인드맵 | 직접 생성 |
|------|----------|---------|----------|
| **리서치 데이터** | ✅ 3개 소스 | ❌ | ❌ |
| **시각적 편집** | ❌ | ✅ 마인드맵 | ❌ |
| **AI 대화** | ❌ | ✅ 채팅 | ❌ |
| **생성 속도** | ⚠️ 느림 (리서치 시간) | ⚠️ 중간 | ✅ 빠름 |
| **아이디어 품질** | ✅ 데이터 기반 | ✅ 구조화 | ⚠️ 기본 |
| **적합한 용도** | 신규 서비스, 창업 | 복잡한 프로젝트 | 빠른 브레인스토밍 |

---

**다음 섹션에서는 이러한 기능들을 구현하는 데 사용된 기술 스택을 상세히 살펴보겠습니다.**
